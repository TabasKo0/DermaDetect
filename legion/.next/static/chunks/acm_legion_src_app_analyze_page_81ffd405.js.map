{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///F:/shiii/acm/legion/src/app/analyze/page.js"],"sourcesContent":["\"use client\";\r\nimport { useState, useRef } from \"react\";\r\n\r\nexport default function DetectPage() {\r\n\tconst [image, setImage] = useState(null);\r\n\tconst [imagePreview, setImagePreview] = useState(null);\r\n\tconst [result, setResult] = useState(null);\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [dragActive, setDragActive] = useState(false);\r\n\tconst inputRef = useRef(null);\r\n\r\n\t// Class information mapping\r\n\tconst classInfo = {\r\n\t\takiec: {\r\n\t\t\tfullName: \"Actinic Keratoses and Intraepithelial Carcinoma (Bowen's disease)\",\r\n\t\t\tdescription: \"Precancerous or cancerous lesions, often scaly or rough.\"\r\n\t\t},\r\n\t\tbcc: {\r\n\t\t\tfullName: \"Basal Cell Carcinoma\",\r\n\t\t\tdescription: \"Most common type of skin cancer, usually slow-growing.\"\r\n\t\t},\r\n\t\tbkl: {\r\n\t\t\tfullName: \"Benign Keratosis-like Lesions\",\r\n\t\t\tdescription: \"Includes seborrheic keratoses, lichenoid keratoses, and solar lentigines (benign, non-cancerous).\"\r\n\t\t},\r\n\t\tdf: {\r\n\t\t\tfullName: \"Dermatofibroma\",\r\n\t\t\tdescription: \"Benign fibrous skin nodule.\"\r\n\t\t},\r\n\t\tmel: {\r\n\t\t\tfullName: \"Melanoma\",\r\n\t\t\tdescription: \"Dangerous skin cancer that can spread rapidly.\"\r\n\t\t},\r\n\t\tnv: {\r\n\t\t\tfullName: \"Melanocytic Nevus\",\r\n\t\t\tdescription: \"Mole (benign proliferation of melanocytes).\"\r\n\t\t},\r\n\t\tvasc: {\r\n\t\t\tfullName: \"Vascular Lesion\",\r\n\t\t\tdescription: \"Includes angiomas, hemangiomas, and pyogenic granulomas (benign blood vessel growths).\"\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleImageChange = (e) => {\r\n\t\tconst file = e.target.files[0];\r\n\t\tif (file) {\r\n\t\t\tsetImage(file);\r\n\t\t\tsetImagePreview(URL.createObjectURL(file));\r\n\t\t\tsetResult(null);\r\n\t\t\tsetError(null);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleDragOver = (e) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tsetDragActive(true);\r\n\t};\r\n\r\n\tconst handleDragLeave = (e) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tsetDragActive(false);\r\n\t};\r\n\r\n\tconst handleDrop = (e) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tsetDragActive(false);\r\n\t\tif (e.dataTransfer.files && e.dataTransfer.files[0]) {\r\n\t\t\tsetImage(e.dataTransfer.files[0]);\r\n\t\t\tsetImagePreview(URL.createObjectURL(e.dataTransfer.files[0]));\r\n\t\t\tsetResult(null);\r\n\t\t\tsetError(null);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleSubmit = async (e) => {\r\n\t\te.preventDefault();\r\n\t\tif (!image) return;\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\tsetResult(null);\r\n\t\ttry {\r\n\t\t\tconst formData = new FormData();\r\n\t\t\tformData.append(\"image\", image);\r\n\t\t\tconst res = await fetch(\"../api/analyze\", {\r\n\t\t\t\tmethod: \"POST\",\r\n\t\t\t\tbody: formData,\r\n\t\t\t});\r\n\t\t\tif (!res.ok) throw new Error(\"API error\");\r\n\t\t\tconst data = await res.json();\r\n\t\t\tsetResult(data);\r\n\t\t} catch (err) {\r\n\t\t\tsetError(err.message);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"analyze-card\" style={{ maxWidth: \"100vw\", minHeight: \"70vh\", padding: \"2rem\" }}>\r\n\t\t\t<div style={{ padding: \"10px\", fontSize: \"30px\", display: \"flex\", justifyContent: \"center\", paddingBottom: \"50px\" }}>\r\n\t\t\t\tImage Detection\r\n\t\t\t</div>\r\n\t\t\t<div className=\"analysis-container\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<form onSubmit={handleSubmit} style={{ marginBottom: \"2rem\" }}>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tonDragOver={handleDragOver}\r\n\t\t\t\t\t\t\tonDragLeave={handleDragLeave}\r\n\t\t\t\t\t\t\tonDrop={handleDrop}\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tborder: imagePreview ? \"none\" : (dragActive ? \"2px solid var(--button-bg)\" : \"2px dashed var(--border-color)\"),\r\n\t\t\t\t\t\t\t\tborderRadius: 8,\r\n\t\t\t\t\t\t\t\tpadding: imagePreview ? \"0\" : \"2rem\",\r\n\t\t\t\t\t\t\t\ttextAlign: \"center\",\r\n\t\t\t\t\t\t\t\tbackground: imagePreview ? \"transparent\" : (dragActive ? \"rgba(25, 118, 210, 0.1)\" : \"var(--card-bg)\"),\r\n\t\t\t\t\t\t\t\tmarginBottom: \"1rem\",\r\n\t\t\t\t\t\t\t\tcursor: \"pointer\",\r\n\t\t\t\t\t\t\t\tposition: \"relative\",\r\n\t\t\t\t\t\t\t\tminHeight: imagePreview ? \"auto\" : \"150px\",\r\n\t\t\t\t\t\t\t\tminWidth: \"36vw\",\r\n\t\t\t\t\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\t\t\t\tjustifyContent: \"center\"\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tonClick={() => inputRef.current && inputRef.current.click()}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{imagePreview ? (\r\n\t\t\t\t\t\t\t\t<img \r\n\t\t\t\t\t\t\t\t\tsrc={imagePreview} \r\n\t\t\t\t\t\t\t\t\talt=\"Selected\" \r\n\t\t\t\t\t\t\t\t\tstyle={{ \r\n\t\t\t\t\t\t\t\t\t\tmaxWidth: \"100%\", \r\n\t\t\t\t\t\t\t\t\t\tmaxHeight: \"300px\", \r\n\t\t\t\t\t\t\t\t\t\tobjectFit: \"contain\",\r\n\t\t\t\t\t\t\t\t\t\tborderRadius: 8\r\n\t\t\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<span style={{ color: \"var(--foreground)\", fontWeight: \"500\" }}>\r\n\t\t\t\t\t\t\t\t\tDrag & drop an image here, or click to select\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\t\tonChange={handleImageChange}\r\n\t\t\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button \r\n\t\t\t\t\t\t\ttype=\"submit\" \r\n\t\t\t\t\t\t\tdisabled={loading || !image} \r\n\t\t\t\t\t\t\tstyle={{ \r\n\t\t\t\t\t\t\t\tmarginLeft: \"1rem\",\r\n\t\t\t\t\t\t\t\tbackground: \"var(--button-bg)\",\r\n\t\t\t\t\t\t\t\tcolor: \"var(--button-text)\",\r\n\t\t\t\t\t\t\t\tborder: \"none\",\r\n\t\t\t\t\t\t\t\tpadding: \"0.5rem 1rem\",\r\n\t\t\t\t\t\t\t\tborderRadius: \"4px\",\r\n\t\t\t\t\t\t\t\tcursor: loading || !image ? \"not-allowed\" : \"pointer\",\r\n\t\t\t\t\t\t\t\topacity: loading || !image ? 0.6 : 1\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{loading ? \"Analyzing...\" : \"Analyze\"}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t\t{error && <div style={{ color: \"#d32f2f\" }}>Error: {error}</div>}\r\n\t\t\t\t<div className=\"result-card\">\r\n\t\t\t\t\t<h3>Result</h3>\r\n\t\t\t\t\t{result ? (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<div><strong>Prediction:</strong> {result.prediction}</div>\r\n\t\t\t\t\t\t\t{classInfo[result.prediction] && (\r\n\t\t\t\t\t\t\t\t<div className=\"class-info-card\">\r\n\t\t\t\t\t\t\t\t\t<div><strong>Full Name:</strong> {classInfo[result.prediction].fullName}</div>\r\n\t\t\t\t\t\t\t\t\t<div style={{ marginTop: \"0.5rem\" }}><strong>Description:</strong> {classInfo[result.prediction].description}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<div><strong>Class Index:</strong> {result.class_idx}</div>\r\n\t\t\t\t\t\t\t<div><strong>Confidence:</strong> {result.confidence !== undefined ? `${(parseFloat(result.confidence) * 100).toFixed(2)}%` : ''}</div>\r\n\t\t\t\t\t\t\t<div style={{ marginTop: \"1rem\" }}>\r\n\t\t\t\t\t\t\t\t<strong>Class Probabilities:</strong>\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t{result.class_probabilities && Object.entries(result.class_probabilities).map(([cls, prob]) => {\r\n\t\t\t\t\t\t\t\t\t\tlet percent = 0;\r\n\t\t\t\t\t\t\t\t\t\tif (typeof prob === 'string' || typeof prob === 'number') {\r\n\t\t\t\t\t\t\t\t\t\t\tpercent = (parseFloat(prob) * 100);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tconst display = `${percent.toFixed(2)}%`;\r\n\t\t\t\t\t\t\t\t\t\treturn <li key={cls}>{cls}: {display}</li>;\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div style={{ color: \"var(--text-muted)\", fontStyle: \"italic\" }}>\r\n\t\t\t\t\t\t\tUpload an image and click \"Analyze\" to see results here.\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}